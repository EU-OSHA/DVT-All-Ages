define(function(require){var AproachService=function(){function Policy(group,countryID,country,pId,psp,main,csname,csurl,shortd,inMap){this.countryId=countryID,this.country=country,this.group=group,this.policyId=pId,this.policy=psp,this.shortd=shortd,this.csname=csname,this.isMain=1==main,this.csurl=csurl,this.inMap=1==inMap}function Factor(factor,factorBlock){this.factor=factor,this.block=factorBlock}function createPolicyWith(mapper){return new Policy(mapper[0],mapper[1],mapper[2],mapper[3],mapper[4],mapper[5],mapper[6],mapper[7],mapper[8],mapper[9])}function update(policy,index,$scope){return policy.isMain&&policy.inMap?$scope.countries[index].policies.main.push(policy):policy.inMap&&$scope.countries[index].policies.other.push(policy),$scope}function insert(policy,index,$scope){return $scope.countries[index]={name:policy.country,countryId:policy.countryId,policies:{main:[],other:[]}},update(policy,index,$scope),$scope}function createFactorWith(mapper){return new Factor(mapper[1],mapper[2])}function updateF(factor,index,$scope){return $scope.groups[index].factors.push(factor),$scope}function insertF(factor,index,$scope){return $scope.groups[index]={factors:[]},updateF(factor,index,$scope),$scope}var i18n=require("json!vertical/approaches/i18n");return{getTab2MainPoliciesData:function($scope){$scope.dashboard.promises.tab2MainPolicies.then(function(dataset){var result=dataset.data.resultset;$scope.countries=[];var country={},policy={},mapper={},countriesIndex=0;for(var index in result)mapper=result[index],country=$scope.countries[countriesIndex],policy=createPolicyWith(mapper),country?country.countryId!==policy.countryId?(countriesIndex+=1,insert(policy,countriesIndex,$scope)):update(policy,countriesIndex,$scope):insert(policy,countriesIndex,$scope);return $scope}).catch(function(err){throw err})},getTab1GroupDescriptionData:function($scope){return $scope.dashboard.promises.tab1GroupDescription.then(function(dataset){$scope.groups=[];var mapper={},group={},factor={},result=dataset.data.resultset;for(var index in result)mapper=result[index],group=$scope.groups[(mapper[0]-1).toString()],factor=createFactorWith(mapper),group?updateF(factor,mapper[0]-1,$scope):insertF(factor,mapper[0]-1,$scope)}).catch(function(err){throw err}),$scope},getIndicatorList:function($scope,$state){return[{id:"getAPMedianAge",title:"Median Age",type:"lines",colorRole:"s",clickAction:function(){$state.go("approaches-enlarge",{indicator:"median-age-time-series",pGroup:"group"+$scope.dashboard.parameters.approach})},axisMin:25,axisMax:55,step:5,orthoAxisTitle:i18n.units.years},{id:"getAPUnemployement",title:"Unemployement",type:"lines",colorRole:"s",clickAction:function(){$state.go("approaches-enlarge",{indicator:"unemployment",pGroup:"group"+$scope.dashboard.parameters.approach})},axisMin:0,axisMax:30,step:5,axisPercent:1},{id:"getAPEmployementOlderWorkers",title:"Older workers employment rates",type:"lines",colorRole:"s",clickAction:function(){$state.go("approaches-enlarge",{indicator:"older-workers-employment-rates",pGroup:"group"+$scope.dashboard.parameters.approach})},axisMin:15,axisMax:100,step:25,axisPercent:1},{id:"getAPOpinionWorkHN",title:"Impact of work on health",type:"bars",colorRole:"c",clickAction:function(){$state.go("approaches-enlarge",{indicator:"impact-of-work-on-health",pGroup:"group"+$scope.dashboard.parameters.approach})},axisMax:100,step:20,axisPercent:1},{id:"getAgeDiscrimination",title:"Age Discrimination",type:"bars",colorRole:"c",clickAction:function(){$state.go("approaches-enlarge",{indicator:"age-discrimination",pGroup:"group"+$scope.dashboard.parameters.approach})},axisMin:10,axisMax:80,step:25,axisPercent:1},{id:"getTrainingOlderWorkers",title:"Participation of training of older workers",type:"bars",colorRole:"c",clickAction:function(){$state.go("approaches-enlarge",{indicator:"participation-in-training",pGroup:"group"+$scope.dashboard.parameters.approach})},axisMax:70,step:25,axisPercent:1}]}}};return AproachService.$inject=[],AproachService});